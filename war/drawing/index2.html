<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
        "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>Simple Sequence</title>
    <link rel="stylesheet" href="./css/sequence.css">

    <script src="./js/jquery.js" type="text/javascript"></script>
    <script src="./js/jquery.ui.min.js" type="text/javascript"></script>
    <script src="js/drawers/lifeline.js" type="text/javascript"></script>
    <script src="js/drawers/rect.js" type="text/javascript"></script>
    <script src="js/drawers/grid.js" type="text/javascript"></script>
    <script src="js/drawers/dots.js" type="text/javascript"></script>
    <script src="js/drawers/label.js" type="text/javascript"></script>
    <script src="js/drawers/arrow_icon_right.js" type="text/javascript"></script>
    <script src="js/drawers/arrow_icon_left.js" type="text/javascript"></script>
    <script src="js/drawers/arrows.js" type="text/javascript"></script>
    <script src="js/drawers/line.js" type="text/javascript"></script>
    <script src="js/drawers/label.js" type="text/javascript"></script>
    <script src="js/drawers/horizontal_line.js" type="text/javascript"></script>
    <script src="js/drawers/horizontal_arrow.js" type="text/javascript"></script>
    <script src="js/drawers/bar.js" type="text/javascript"></script>
    <script src="js/drawers/entity.js" type="text/javascript"></script>
    <script src="js/drawers/message.js" type="text/javascript"></script>
    <script src="js/drawers/internal_invoke.js" type="text/javascript"></script>
    <script src="js/domain/entities.js" type="text/javascript"></script>
    <script src="js/domain/message.js" type="text/javascript"></script>
    <script src="js/domain/messages.js" type="text/javascript"></script>
    <script src="js/domain/activity_sequence.js" type="text/javascript"></script>
    <script src="js/drawers/sequence_printer.js" type="text/javascript"></script>
    <script src="js/presentation/presentation_entities.js" type="text/javascript"></script>

    <script src="./js/presentation/canvas_manager.js" type="text/javascript"></script>

    <script type="text/javascript">

        $(document).ready(function() {
            window.canvasManager = new CanvasManager($('#canvasContainer'));
            window.activitySequence = new ActivitySequence("");
            reDrawSequenceDiaWithScript();
//            canvasManager.addEntity("One");
//            canvasManager.addEntity("Two");
//            canvasManager.addEntity("Three");
//            var syncMessage = new SyncMessage("One", "Two", "Message");
//            canvasManager.addSubMessage(syncMessage);
//            var subMessage1 = new SyncMessage("Two", "Three", "Message1");
//            canvasManager.addSubMessage(subMessage1);
//            var subMessage2 = new SyncMessage("Three", "One", "Message2");
//            canvasManager.addSubMessage(subMessage2);
//            var subMessage3 = new SyncMessage("Two", "One", "Message2");
//            canvasManager.addSubMessage(subMessage3);

        });

        function collapse() {
            if ($("#handle").hasClass("collapse")) {
                $("#handle").removeClass("collapse");
                $("#handle").addClass("expand");
                $("#script_container").removeClass("collapse");
                $("#script_container").addClass("expand");
                $("#floating_container").removeClass("collapse");
                $("#floating_container").addClass("expand");
            } else {
                $("#handle").removeClass("expand");
                $("#handle").addClass("collapse");
                $("#script_container").removeClass("expand");
                $("#script_container").addClass("collapse");
                $("#floating_container").removeClass("expand");
                $("#floating_container").addClass("collapse");

            }
        }

        function reDrawSequenceDiaWithScript() {
            draw($("#scriptContent")[0].value);
        }

        function draw(scriptContent) {
            window.activitySequence.draw(window.canvasManager, scriptContent);
        }

        
    </script>
</head>
<body>
<div id="canvasContainer" class="scroll" style="position: relative;">
    <div id="floating_container" class="expand">
        <div id="script_title">Pseudo Code:</div>
        <div style="float: right;">
            <span id="handle" class="expand" onclick="collapse()"></span>
        </div>
        <div id="script_container" class="expand">
            <span id="mouse_position">debug info come here.</span> <br/>
            <span id="entity_info">debug info come here.</span> <br/>
            <span id="key_press">debug info come here.</span> <br/>
            <textarea id="scriptContent"
                      title="Script Content"
                      style="width:100%;height:100%"
                      onblur="reDrawSequenceDiaWithScript()">From:Return=To.Message</textarea>
        </div>

    </div>
     
</div>

<span id=entity_background style=display:none>
    <img id="entity_tl" src="resource/tl.gif"/>
    <img id="entity_tr" src="resource/tr.gif"/>
    <img id="entity_bl" src="resource/bl.gif"/>
    <img id="entity_br" src="resource/br.gif"/>
    <img id="entity_in" src="resource/in.png"/>
 </span>
<span id="for_css_util" style="display:none">
    <span id=entityBox class="entityBox"></span>
    <span id=line class="line"></span>
    <span id=message class="message"></span>
    <span id=canvas class="canvas"></span>
</span>

<span id="small_arrow_icon" style="display:none">
    <img id="arrow_left" src="resource/arrow_left.gif">
    <img id="arrow_right" src="resource/arrow_right.gif">
</span>
</body>
</html>